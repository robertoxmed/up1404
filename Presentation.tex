\documentclass{beamer}

\usepackage[frenchb]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{keystroke}

\usetheme{Warsaw}

\newcommand{\prompt}[1]{\footnotesize \colorbox{black}{\textcolor{white}{\texttt{user@hôte:\textasciitilde\$ #1}}}\normalsize}
\definecolor{ubuntu}{HTML}{dd4814}

\title[Ubuntu Party - 14.04]{Initiation à la ligne de commande}
\author{Roberto Medina}
\institute{roberto@mambochimbo.com}
\date{24 Mai 2014}
\titlegraphic{\includegraphics[width=3cm]{ubuntuparty_logo.eps}}

\setbeamercolor{structure}{fg=ubuntu!90!ubuntu}
\setbeamertemplate{frametitle}
{
    \nointerlineskip
    \begin{beamercolorbox}[sep=0.3cm,ht=1.8em,wd=\paperwidth]{frametitle}
        \vbox{}\vskip-2ex%
        \strut\insertframetitle\strut
        \vskip-0.8ex%
    \end{beamercolorbox}
}
\begin{document}
\begin{frame}[plain]
        \titlepage
        \center \includegraphics[width=2cm]{licence.eps}
    \end{frame}
    
    \begin{frame}[plain]
        \frametitle{Sommaire}
        \begin{itemize}
            \item Présentation de l'outil
            \item Commandes de base
            \item Système de fichiers, droits
            \item Gestion de processus
            \item Gestionnaire de paquets
            \item Gestion de services
        \end{itemize}
    \end{frame}

    %Première section (Introduction)
    \section{Présentation de l'outil}
    \subsection{Un peu d'histoire}
    \begin{frame}
        \frametitle{Un peu d'histoire}
        \begin{itemize}
            \item Qu'est-ce qu'un {\bf Shell} ?
                \begin{itemize}
                    \item Interface (logicielle) avec la machine.
                    \item Interaction avec la machine à travers des commandes.
                    \item Utilisé avant la souris, toujours présent à cause de son efficacité.
                \end{itemize}
            \item Exemples de Shell
                \begin{itemize}
                    \item Bourne Shell ({\bf bs})
                    \item Bourne Again Shell ({\bf bash}) - Installé par défaut sur Ubuntu.
                    \item Z Shell ({\bf zsh}) - Populaire entre les utilisateurs plus avancés.
                \end{itemize}
        \end{itemize}
    \end{frame}
    
    \subsection{Le terminal}
    \begin{frame}
        \frametitle{Le Terminal}
        \begin{itemize}
            \item Un {\bf terminal} : logiciel qui interprète des commandes shell.
                \begin{itemize}
                    \item Ouvrir un terminal : \Ctrl + \Alt + \keystroke{T} sous Unity.
                    \item Différents terminales (dépend souvent de votre bureau)
                        \begin{itemize}
                            \item {\bf gnome-terminal} sous Unity, Cinnamon et Gnome
                            \item {\bf konsole} sous KDE
                            \item Autres options: {\bf xterm, terminator, finalterm}...
                        \end{itemize}
                \end{itemize}
        \end{itemize}
    \end{frame}
    
    \subsection{Invite de commande}
    \begin{frame}
        \frametitle{Invite de commande}
        \center{\prompt{echo 'Hello world!'}}
        \begin{itemize}
            \item {\bf \texttt{user}} : Nom d'utilisateur.
            \item {\bf \texttt{hôte}} : Nom de la machine.
            \item {\bf \texttt{\~}} : Désigne le répertoire courant.
            \item {\bf \texttt{\$}} : Identifie le type d'utilisateur
            \begin{itemize}
                \item \texttt{\#} : Il s'agit d'un super-utilisateur
                \item \texttt{\%} : Utilisateur sous zsh
                \end{itemize}
        \end{itemize}
    \end{frame}
   
    %Deuxième section (Commandes basiques)
    \section{Commandes de base}
    \subsection{Gestion de fichiers}
    \begin{frame}
        \frametitle{Gestion de fichiers}
        {\bf commande -option1 -option2 ... argument1 argument2}
        \begin{itemize}
            \item {\bf ls} : lister le contenu d'un répertoire
                \begin{itemize}
                    \item Sans argument, liste le contenu du répertoire courant.
                    \item {\bf ls -a} : montre les fichiers cachés.
                    \item {\bf ls -l} : montre les détails des fichiers.
                    \item {\bf ls }{\bf <répertoire>} : liste le contenu du répertoire.
                \end{itemize}
            \item {\bf cd} : changer de répertoire (on y reviendra dessus...)
            \item {\bf mkdir} : créer un répertoire
        \end{itemize}
        \begin{block}{Attention !}
            Les commandes doivent respecter les minuscules/majuscules.\newline
            {\bf ls -r} n'est pas pareil que {\bf ls -R}
        \end{block}
    \end{frame}

    \begin{frame}
        \frametitle{Un exemple}
        \includegraphics[width=11.5cm,height=3.5cm]{exemple_fichiers.eps}
    \end{frame}

    \subsection{Complétion}
    \begin{frame}
        \frametitle{Complétion}
        Ça permet d'éviter les erreurs de frappe et on peut aller plus vite.\newline \newline
        Compléter le nom d'un fichier:
        \begin{itemize}
            \item {\bf cd Doc} \Tab => {\bf cd Documents}
            \item {\bf cd D} \Tab \Tab
                \newline => Liste tous les répertoires commençant par {\bf D}
        \end{itemize}
    \end{frame}

    \subsection{Gestion de fichiers (2)}
    \begin{frame}
        \frametitle{Gestion de fichiers (2)}
        \begin{itemize}
            \item {\bf rm} : supprimer des fichiers
                \begin{itemize}
                    \item {\bf rm -r} : supprimer des répertoires. {\bf -r} veut dire récursif.
                    \item {\bf rm -f} : forcer la suppression.
                \end{itemize}
            \item {\bf cp} : copier des fichiers
                \begin{itemize}
                    \item {\bf cp <fichier1> ... <fichierN> <destination>}
                        \begin{itemize}
                            \item Destination devrait être un répertoire, sinon contenu remplacé.
                            \item On peut copier plusieurs fichiers à la fois.
                            \item {\bf cp -r} : copier des répertoires.
                        \end{itemize}
                \end{itemize}
        \end{itemize}
    \end{frame}
    
    \begin{frame}
        \frametitle{Autres commandes utiles}
        \begin{itemize}
            \item {\bf mv} : déplacer des fichiers
                \begin{itemize}
                    \item Même syntaxe que {\bf cp}.
                \end{itemize}
            \item {\bf echo} : affiche une ligne de texte ou une variable d'environnement.
            \item {\bf cat} : affiche le contenu d'un fichier.
        \end{itemize}
    \end{frame}

    \subsection{Le manuel}
    \begin{frame}
        \frametitle{Le manuel}
        {\bf man} : commande pour consulter le manuel d'une commande ou d'un programme
        \begin{itemize}
            \item Utilisation : {\bf man <commande>}
            \item Très important et très utile! À utiliser sans modération.
            \item En cas d'ambigüité on utilise différentes sections du manuel.
                \begin{itemize}
                    \item {\bf man kill} affiche le manuel de la commande {\bf kill} utilisée par le shell.
                    \item {\bf man 2 kill} affiche le manuel de la fonction \texttt{kill} de POSIX.
                \end{itemize}
            \item Quitter le manuel \keystroke{Q}
            \item {\bf man -k <mot clé>} : pour chercher une commande.
            \item {\bf man man} : consulter le manuel du manuel.
        \end{itemize}
    \end{frame}

    \begin{frame}
        \frametitle{Un exemple de manuel}
        \includegraphics[width=10.5cm, height=5.5cm]{man.eps}
    \end{frame}
    
    %Troisième section: Système de fichiers
    \section{Système de fichiers}
    \subsection{Description du système de fichiers}
    \begin{frame}
        \frametitle{Description du système de fichiers}
        \begin{itemize}
            \item Sous UNIX et donc sous Linux, {\bf TOUT} est un fichier (ou presque...)
            \item Souris, clavier, écran, disque dur... sont des fichiers.
            \item Arborescence utilisée par le système.
                \begin{itemize}
                    \item {\bf /} : racine du système.
                    \item {\bf /home} : dossier avec les données personnelles des utilisateurs.
                    \item {\bf /etc} : réglages par défaut des programmes.
                    \item {\bf /dev} : les devices (comme le disque dur).
                \end{itemize}
        \end{itemize}
    \end{frame}

    \subsection{Se déplacer dans l'arborescence}
    \begin{frame}
        \frametitle{Se déplacer dans l'arborescence}
        Retour sur {\bf cd}.
        \begin{itemize}
            \item {\bf cd /} : aller à la racine.
            \item {\bf cd} : sans arguments, aller dans le répertoire personnel.\newline
                Équivalent à {\bf cd /home/<votre utilisateur>}
            \item {\bf cd ..} : pour monter dans le répertoire père.\newline
                {\bf cd ../../..} : nous fait remonter de trois répertoires.
            \item {\bf pwd} : affiche le chemin absolu du répertoire courant. 
        \end{itemize}
    \end{frame}

    \subsection{Illustration de l'arborescence}
    \begin{frame}
        \frametitle{Illustration de l'arborescence}
        \includegraphics[width=10.5cm, height=5.5cm]{arborescence.eps}
    \end{frame}

    \subsection{Droits sur les fichiers}
    \begin{frame}
        \frametitle{Droits sur les fichiers}
        Retour sur {\bf ls}.
        \begin{itemize}
            \item {\bf ls -l} : montre les détails sur les fichiers.
            \item À gauche on retrouve les différents droits d'accès pour les utilisateurs.
                \begin{itemize}
                    \item {\bf d} (pour Directory) indique si c'est un répertoire.
                    \item {\bf r} (pour Read) indique si on peut lire sur le fichier.
                    \item {\bf w} (pour Write) indique si on peut écrire sur le fichier.
                    \item {\bf x} (pour eXecute) indique si on peut exécuter le fichier.
                \end{itemize}
        \end{itemize}
    \end{frame}

    \begin{frame}
        \frametitle{Exemple de droits}
        \includegraphics[width=10.5cm, height=5cm]{droits.eps}
    \end{frame}

    \subsection{Changement de droits}
    \begin{frame}
        \frametitle{Changement de droits}
        \begin{itemize}
            \item {\bf chmod} : pour changer les droits sur des fichiers.
            \item Mode octal:
                \begin{itemize}
                    \item {\bf chmod 755 <mon fichier>} chaque champ est représenté par un bit.
                    \item Pas très pratique, faut savoir compter en binaire.
                \end{itemize}
            \item Mode avec caractères:
                \begin{itemize}
                    \item {\bf chmod u+x <mon fichier>} rajoute les droits d'exécution pour l'utilisateur.
                    \item {\bf chmod +r <mon fichier>} droits d'exécution pour tous les utilisateurs.
                    \item {\bf chmod g-w <mon fichier>} enlève les droits d'écriture pour le groupe.
                \end{itemize}
            \item {\bf chmod <droits> -R <mon répertoire>} : changer les droits sur un répertoire.
        \end{itemize}
    \end{frame}
    
    %Quatrième section : Gestion de processus
    \section{Gestion de processus}
    \subsection{Lancer des programmes}
    \begin{frame}
        \frametitle{Lancer des programmes}
        {\bf programme -option1 -option2 ... argument1 argument2}
        \begin{itemize}
            \item {\bf gedit toto.txt} : ouvre l'éditeur de texte avec le fichier \texttt{toto.txt}.
            \item Le PID (Process ID) s'affiche après avoir lancer un programme.
            \item Le terminal ne rend pas la main.\newline
                Lancer le programme suivi du symbole \texttt{\&}\newline
                Ex : {\bf gedit toto.txt \&}
        \end{itemize}
    \end{frame}

    \subsection{Arrière et premier plan}
    \begin{frame}
        \frametitle{Arrière et premier plan}
        \begin{block}{Un exemple}
        Lancer {\bf firefox} sans le \texttt{\&} .\newline
        Comment récupérer l'invite de commande?
        \end{block}
        \begin{itemize}
            \item Terminer le processus : \Ctrl + \keystroke{C}
            \item Mettre en pause le processus : \Ctrl + \keystroke{Z}
                \newline Utiliser la commande {\bf bg} pour reprendre la main.
        \end{itemize}
    \end{frame}

    \subsection{Les commandes \texttt{ps} et \texttt{kill}}
    \begin{frame}
        \frametitle{Les commandes \texttt{ps} et \texttt{kill}}
        \begin{itemize}
            \item {\bf ps} : liste les processus. A besoin d'options pour être lisible.
                \begin{itemize}
                    \item {\bf ps -e} tous les processus.
                    \item {\bf pstree} arborescence de processus.
                \end{itemize}
            \item {\bf kill} : envoyer un signal au processus.
                \begin{itemize}
                    \item {\bf kill -<Num de signal> <PID>}
                    \item {\bf kill -9 <PID>} : terminer brutalement un processus.
                    \item {\bf killall <Nom programme>} : termine tous les processus du groupe ayant le même nom.
                \end{itemize}
        \end{itemize}
    \end{frame}

    \subsection{L'utilitaire \texttt{top}}
    \begin{frame}
        \frametitle{L'utilitaire \texttt{top}}
        \includegraphics[width=10cm, height=5.5cm]{top.eps}
    \end{frame}

    %Cinquième section : gestion de paquets
    \section{Gestion de paquets}
    \begin{frame}
        \frametitle{Description du gestionnaire}
        On peut gérer des paquets, des programmes depuis la ligne de commande.
        \begin{itemize}
            \item {\bf apt-get} : gestionnaire par défaut dans Ubuntu.
            \item Nécessite des droits de super-utilisateur (root).
            \item {\bf sudo} : commande permettant de lancer une autre commande comme root.
        \end{itemize}
        \begin{block}{sudo}
            Le mot de passe n'est pas affiché pour des raisons de sécurité.\newline
            Faire attention chaque fois que vous voyez {\bf sudo} quelque part.
        \end{block}
    \end{frame}

    \subsection{Installer et mettre à jour}
    \begin{frame}
        \frametitle{Mises à jour et installations}
        \begin{itemize}
            \item {\bf sudo apt-get update} : met à jour la liste des paquets disponibles.
            \item {\bf sudo apt-get upgrade} : met à jour les paquets (sûrs) installés.
                \begin{itemize}
                    \item {\bf sudo apt-get update \&\& sudo apt-get upgrade} enchaîner la mise à jour de\
                        la base avec la mise à jour des paquets.
                    \item \texttt{\&\&} indique qu'on fait l'enchaînement seulement si le programme d'avant\
                        réussi.
                \end{itemize}
            \item {\bf sudo apt-get dist-upgrade} : met à jour les paquets plus critiques (comme le noyau).
            \item {\bf sudo apt-get install <nom du programme>} : pour installer des programmes.
            \item {\bf sudo apt-get install prog1 prog2 ... progN} installer plusieurs programmes à la fois.
        \end{itemize}
    \end{frame}

    \begin{frame}
        \frametitle{Exemple d'utilisation}
        \center \includegraphics[width=6cm, height=5.5cm]{apt-get.eps}
    \end{frame}

    \subsection{Désinstaller et nettoyer le cache}
    \begin{frame}
        \frametitle{Enlever des paquets et nettoyer le cache}
        \begin{itemize}
            \item {\bf sudo apt-get remove <paquet>} : désinstalle le paquet, mais pas ses fichiers de configuration.
            \item {\bf sudo apt-get purge <paquet>} : désinstallation et enlève les fichiers de conf.
            \item {\bf sudo apt-get autoremove} : enlève les paquets orphelins.
            \item {\bf sudo apt-get autoclean} : pour nettoyer le cache de {\bf apt-get}.
        \end{itemize}
    \end{frame}

    \subsection{Chercher des paquets}
    \begin{frame}
        \frametitle{Chercher des paquets}
        \begin{itemize}
            \item {\bf apt-cache search <mot clé>} : chercher des paquets installables avec {\bf apt-get}.
            \item Le gestionnaire {\bf aptitude} a la même syntaxe mais possède quelques améliorations. Consulter le manuel.
            \item {\bf sudo apt-get install aptitude}.
        \end{itemize}
    \end{frame}
    
    %Sixième section : Gestion de services
    \section{Gestion de services}
    \subsection{Démerrage de services}
    \begin{frame}
        \frametitle{Démarrage de services}
        Utile quand on veut administrer un serveur par exemple.
        \begin{itemize}
            \item {\bf /etc/init.d} : contient tous les services activés au démarrage.
                \begin{itemize}
                    \item Gestion d'Apache
                    \item {\bf sudo /etc/init.d/apache2 start}
                    \item {\bf sudo /etc/init.d/apache2 stop}
                    \item Pour des versions récentes:
                        \begin{itemize}
                            \item {\bf sudo apache2 start}
                            \item {\bf sudo apache2 restart}
                        \end{itemize}
                \end{itemize}
        \end{itemize}
    \end{frame}

    \subsection{Lister les services}
    \begin{frame}
        \frametitle{Lister les différents services}
        Ubuntu utilise Upstart pour démarrer des services.
        \begin{itemize}
            \item {\bf initctl list} : lister les services qui tournent.
            \item {\bf sudo initctl stop <nom du service>} : pour arrêter un service.
            \item {\bf sudo initctl start <nom du service>} : pour démarrer un service.
        \end{itemize}
    \end{frame}

    \begin{frame}{Autres commandes à regarder...}
        \begin{itemize}
            \item Les boucles : {\bf for, while, case, if}.
            \item Manipulation des fichiers : {\bf chown, ln, mount, umount, df}.
            \item Recherche : {\bf find, grep}.
            \item Communication : {\bf ssh, telnet, scp, wget}.
        \end{itemize}
    \end{frame}

    \begin{frame}[plain]
        \frametitle{Bibliographie}
        \begin{itemize}
            \item Ce cours sous Github:
                \newline \href{http://tinyurl.com/PresUP1404}{http://tinyurl.com/PresUP1404}

            \item Le cours de l'UP précédante:
                \newline \href{http://tinyurl.com/PresUP1310} {http://tinyurl.com/PresUP1310}          
        \end{itemize}

    \end{frame}

\end{document}
